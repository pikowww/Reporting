<!DOCTYPE html>
<html>
<body>
<p style="position:absolute;top:16%;left:5%;width:50%;font-size:200%;color:white">
<h>Choose a Report:</h>
</p>
<body bgcolor="#143250">
</body>
<p style="position:absolute;top:25%;left:5%;">
<select id="Report">
  <option value="author">Top Authors</option>
  <option value="Top Pageviews">Top Pageviews</option>
  <option value="Top Engaged Time">Top Engaged Time</option>
  <option value="Top Section">Top Section</option>
</p>
</select>
<p style="position:absolute;top:30%;left:5%;">
<select id="Frequency">
  <option value="day">Yesterday</option>
  <option value="week">Past Week</option>
  <option value="month">Past Month</option>
</select>
</p>
<p style="position:absolute;top:16%;left:65%;width:50%;font-size:200%;color:white";>
<a href="https://www.google.com"> Enter your API Key:</a>
</p>


<form id="form" onsubmit="return false;">
<input   style=position:absolute;top:26%;left:65%;width:20%; type="text" id="userApi">
<input   style=position:absolute;top:50%;left:35%;width:20%; type="submit"    onclick="othername()">
</form>

<p style="position:absolute;top:16%;left:35%;width:50%;font-size:200%;color:white";>
Domain / Website:
</p>


<form id="form" onsubmit="return false;">
<input   style=position:absolute;top:26%;left:34%;width:20%; type="text" id="domain">
</form>

<p style="position:absolute;top:-4%;left:30%;width:50%;font-size:400%;color:white";>
Quick Queries v 1.0
</p>

<script>


function httpGet(theUrl)
{
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
    xmlHttp.send( null );
    return xmlHttp.responseText;
}

function othername()
{
//var input = document.getElementById("userEmail").value;
var input2 = document.getElementById("userApi").value;
var input3 = document.getElementById("domain").value;
var inputr = document.getElementById("Report").value;
var inputf = document.getElementById("Frequency").value;
var d = new Date().toISOString().slice(0,10);
var convert = new Date();

//alert(inputf);


if (inputf == "day" & inputr == "author"){
   convert.setDate(convert.getDate()-1)
   var cmon = convert.toISOString().slice(0,10)


var result = httpGet("http://api.chartbeat.com/query/v2/submit/page/?host=" + input3 + "&apikey=" + input2 + "&start=" + cmon + "&end=" + d + "&metrics=page_views&dimensions=" + inputr);

console.log(result);

var obj = JSON.parse(result);

console.log(obj.query_id);

window.location = "http://api.chartbeat.com/query/v2/fetch/?host=" + input3 + "&apikey=" + input2 + "&query_id=" + obj.query_id;
}
else if (inputf == "week" & inputr == "author"){
convert.setDate(convert.getDate()-7)
 var cmon = convert.toISOString().slice(0,10)
 var result = httpGet("http://api.chartbeat.com/query/v2/submit/page/?host=" + input3 + "&apikey=" + input2 + "&start=" + cmon + "&end=" + d + "&metrics=page_views&dimensions=" + inputr);

 console.log(result);

 var obj = JSON.parse(result);

 console.log(obj.query_id);

 window.location = "http://api.chartbeat.com/query/v2/fetch/?host=" + input3 + "&apikey=" + input2 + "&query_id=" + obj.query_id;
}
else{
convert.setDate(convert.getDate()-30)
var cmon = convert.toISOString().slice(0,10)
var result = httpGet("http://api.chartbeat.com/query/v2/submit/page/?host=" + input3 + "&apikey=" + input2 + "&start=" + cmon + "&end=" + d + "&metrics=page_views&dimensions=" + inputr);

console.log(result);

var obj = JSON.parse(result);

console.log(obj.query_id);

window.location = "http://api.chartbeat.com/query/v2/fetch/?host=" + input3 + "&apikey=" + input2 + "&query_id=" + obj.query_id;
}
}



//http://api.chartbeat.com/query/v2/fetch/?host={host}&apikey={apikey}&query_id={query_id}
</script>
</body>
</html>
